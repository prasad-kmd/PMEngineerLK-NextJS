"use client"

import { Share2 } from "lucide-react"
import { cn } from "@/lib/utils"
import { useState } from "react"

export function WebShareButton() {
  const [copied, setCopied] = useState(false)

  const handleShare = async () => {
    const shareData = {
      title: document.title,
      text: "Check out this page!",
      url: window.location.href,
    }

    if (navigator.share) {
      try {
        await navigator.share(shareData)
      } catch (error) {
        console.error("Error sharing:", error)
      }
    } else {
      try {
        await navigator.clipboard.writeText(shareData.url)
        setCopied(true)
        setTimeout(() => setCopied(false), 2000) // Reset after 2 seconds
      } catch (error) {
        console.error("Failed to copy URL:", error)
        alert("Failed to copy URL. Please copy it manually.")
      }
    }
  }

  return (
    <button
      onClick={handleShare}
      data-testid="share-button"
      className={cn(
        "flex w-full items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",
        "text-muted-foreground hover:bg-muted hover:text-foreground",
      )}
    >
      <Share2 className="h-5 w-5" />
      <span>{copied ? "Copied!" : "Share"}</span>
    </button>
  )
}
